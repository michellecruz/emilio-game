(this["webpackJsonpmilio-food"]=this["webpackJsonpmilio-food"]||[]).push([[0],{11:function(e,t,i){e.exports=i(18)},16:function(e,t,i){},17:function(e,t,i){},18:function(e,t,i){"use strict";i.r(t);var a,n,o,r,s,l,d,c,m,p,u,w,h,f,b,g,y,v,x,k,E,j,M,S,z,C,T,P,q,W,A=i(1),D=i.n(A),K=i(7),O=i.n(K),R=(i(16),i(2)),F=i(8),H=i(4),N=i(3),B=i(0),I=i(9),L=i(10),J=[],U=1,X=!1,Z=0,_=!1,G=!1,Q=0,V=4*window.innerWidth,Y=4*window.innerHeight,$=500,ee=function(e){Object(H.a)(i,e);var t=Object(N.a)(i);function i(){var e;Object(R.a)(this,i);for(var A=arguments.length,D=new Array(A),K=0;K<A;K++)D[K]=arguments[K];return(e=t.call.apply(t,[this].concat(D))).state={timeElapsed:0,width:window.innerWidth,height:window.innerHeight,shadow:{blur:3.5,darkness:1,opacity:1},plane:{color:"#ffffff",opacity:1},kibbleEaten:0,emilio:{isEating:!1,isTwirling:null,position:{x:-700,y:500,z:0},rotation:{x:0,y:6.5,z:0}}},e.init=function(){var t=document.querySelector(".container"),i=document.querySelector(".emiliocanvas");l=(new B.q).load("img/emilio-0-new.jpg"),d=(new B.q).load("img/emilio-1-new.jpg"),u=(new B.q).load("img/kibble.png"),(a=new B.k(50,window.innerWidth/window.innerHeight,1,1e4)).position.set(0,400,2e3),(n=new B.n).background=new B.b(16777215),s=new B.p(100,32,32),(c=new B.g({map:l})).side=B.d,(m=new B.f(s,c)).name="Emilio",(g=new B.f).visible=!1,y=new B.i,g.add(y),v=new B.r,y.position.set(0,0,2e3),m.position.x=e.state.emilio.position.x,m.position.y=e.state.emilio.position.y,m.position.z=e.state.emilio.position.z,m.rotation.x=e.state.emilio.rotation.x,m.rotation.y=e.state.emilio.rotation.y,m.rotation.z=e.state.emilio.rotation.z,m.material.map.needsUpdate=!0,n.add(m),n.add(g),e.addShadow(),e.addKibble(),f=new B.m,(o=new B.t({antialias:!0})).setPixelRatio(window.devicePixelRatio),o.setSize(e.state.width,e.state.height),t.replaceChild(o.domElement,i),r=o.getContext("2d").canvas,e.setState({width:r.clientWidth,height:r.clientHeight})},e.addShadow=function(){(k=new B.e).position.y=-100,n.add(k),(E=new B.s(512,512)).texture.generateMipmaps=!1,(j=new B.s(512,512)).texture.generateMipmaps=!1;var t=new B.l(V,Y).rotateX(Math.PI/2),i=new B.g({map:E.texture,opacity:e.state.shadow.opacity,transparent:!0});P=new B.f(t,i),k.add(P),P.scale.y=-1,(q=new B.f(t)).visible=!1,k.add(q),i=new B.g({color:e.state.plane.color,opacity:e.state.plane.opacity,transparent:!0}),(W=new B.f(t,i)).rotateX(Math.PI/2),k.add(W),(M=new B.j(-V/2,V/2,Y/2,-Y/2,0,$)).rotation.x=Math.PI/2,k.add(M),S=new B.a(M),(z=new B.h).userData.darkness={value:e.state.shadow.darkness},z.onBeforeCompile=function(e){e.uniforms.darkness=z.userData.darkness,e.fragmentShader="\n        uniform float darkness;\n        ".concat(e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );"),"\n    ")},z.depthTest=!1,z.depthWrite=!1,(C=new B.o(I.a)).depthTest=!1,(T=new B.o(L.a)).depthTest=!1},e.blurShadow=function(t){q.visible=!0,q.material=C,q.material.uniforms.tDiffuse.value=E.texture,C.uniforms.h.value=1*t/e.state.width*2,o.setRenderTarget(j),o.render(q,M),q.material=T,q.material.uniforms.tDiffuse.value=j.texture,T.uniforms.v.value=1*t/e.state.height*2,o.setRenderTarget(E),o.render(q,M),q.visible=!1},e.addKibble=function(){p=new B.c(100,100,200,200),(w=new B.g({map:u,transparent:!0})).side=B.d;for(var e=0;e<200;e++)(h=new B.f(p,w)).rotation.x=m.rotation.x,h.rotation.y=m.rotation.y,h.rotation.z=m.rotation.z,h.position.x=78e3*Math.random()+2e3,h.position.y=1e3*Math.random()+0,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",n.add(h),J.push(h)},e.animate=function(){requestAnimationFrame(e.animate),e.setState({timeElapsed:e.state.timeElapsed+1}),g.position.x=m.position.x,g.position.y=m.position.y,k.position.x=m.position.x,e.state.kibbleEaten>=99&&e.state.kibbleEaten<=399?(m.position.x+=30,U=1.1):e.state.kibbleEaten>399?(m.position.x+=40,U=1.2):m.position.x+=20,m.position.y>10?(G||(m.position.y-=10),_||(m.material.map=d)):m.position.y=0,(x=new B.r).set(m.position.x,m.position.y,0).normalize(),x.cross(B.i.DefaultUp),m.rotateOnAxis(x,-.05*U),v.setFromMatrixPosition(y.matrixWorld),a.position.lerp(v,.4),a.lookAt(g.position),a.updateProjectionMatrix();var t=n.background;n.background=null,S.visible=!1,n.overrideMaterial=z,o.setRenderTarget(E),o.render(n,M),n.overrideMaterial=null,S.visible=!0,e.blurShadow(e.state.shadow.blur),e.blurShadow(.4*e.state.shadow.blur),o.setRenderTarget(null),n.background=t,m.position.y<=0&&!_&&(m.material.map=l),e.eatKibble(),G&&e.jump(),X?(0,Z+=1):(Z=0,1),e.twirl(),_&&e.eat(),o.render(n,a),a.updateProjectionMatrix()},e.eatKibble=function(){f.set(m.position,new B.r(-1,1,0)),m.geometry.computeBoundingBox(),b=f.intersectObjects(J),_=!1,b.length>0?(_=!0,e.setState({emilio:{isEating:!0},kibbleEaten:e.state.kibbleEaten+1})):(_=!1,e.setState({emilio:{isEating:!1}}));for(var t=0;t<b.length;t++)b.length>0&&"Kibble"===b[t].object.name&&(b[t].object.visible=!1)},e.eat=function(){X||(m.rotation.x=-.2,m.rotation.y=6.5,m.rotation.z=-1.2),requestAnimationFrame((function(){m.material.map===l?setTimeout((function(){m.material.map=d,m.material.map===d&&setTimeout((function(){m.material.map=l}),60)}),60):setTimeout((function(){m.material.map=l}),60)}))},e.twirl=function(){switch(X){case!0:m.rotation.z=-1.2,m.rotation.x=-.1,m.rotation.y=Z,m.rotation.y>=34&&(m.rotation.y=34.4);break;case!1:m.rotation.x=0,m.rotation.y=6.5}},e.jump=function(){(Q+=Q+1)<=150?m.position.y<4e3&&(m.position.y+=30+2*Math.sin(Q)):(G=!1,Q=0)},e.rotateCamera=function(){e.state.width<e.state.height&&(Y=4*window.innerWidth,V=4*window.innerHeight,$=500,a.up=new B.r(-1,0,0),a.updateProjectionMatrix(),document.body.classList.add("mobile"))},e}return Object(F.a)(i,[{key:"componentDidMount",value:function(){this.init(),this.animate(),this.rotateCamera(),document.addEventListener("keydown",(function(e){if(32===e.keyCode&&(G=!0),84===e.keyCode)switch(X){case!1:X=!0;break;case!0:X=!1}})),window.addEventListener("touchstart",(function(){G=!0}))}},{key:"render",value:function(){return D.a.createElement("div",{className:"container"},D.a.createElement("div",{className:"note"},"press the spacebar or tap to jump"),D.a.createElement("div",{id:"count",className:"".concat(this.state.emilio.isEating?"active":"")},this.state.kibbleEaten),D.a.createElement("div",{className:"emiliocanvas"}))}}]),i}(A.Component);i(17);var te=function(){return D.a.createElement("div",{className:"App"},D.a.createElement(ee,null))};O.a.render(D.a.createElement(D.a.StrictMode,null,D.a.createElement(te,null)),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.cb978aca.chunk.js.map