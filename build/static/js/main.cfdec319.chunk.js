(this["webpackJsonpmilio-food"]=this["webpackJsonpmilio-food"]||[]).push([[0],{11:function(e,t,i){e.exports=i(18)},16:function(e,t,i){},17:function(e,t,i){},18:function(e,t,i){"use strict";i.r(t);var a,o,n,s,r,l,c,d,p,m,u,w,h,b,f,y,x,g,v,k,E,z,j,M,S,C,T,K,P,q,W,A=i(1),D=i.n(A),O=i(7),R=i.n(O),F=(i(16),i(2)),H=i(8),N=i(4),B=i(3),I=i(0),L=i(9),J=i(10),U=[],X=[],Z=1.4,_=!1,G=0,Q=!1,V=!1,Y=0,$=4*window.innerWidth,ee=4*window.innerHeight,te=500,ie=function(e){Object(N.a)(i,e);var t=Object(B.a)(i);function i(){var e;Object(F.a)(this,i);for(var A=arguments.length,D=new Array(A),O=0;O<A;O++)D[O]=arguments[O];return(e=t.call.apply(t,[this].concat(D))).state={timeElapsed:0,width:window.innerWidth,height:window.innerHeight,shadow:{blur:3.5,darkness:1,opacity:1},plane:{color:"#ffffff",opacity:1},kibbleEaten:0,emilio:{isEating:!1,isTwirling:null,position:{x:-700,y:500,z:0},rotation:{x:0,y:6.5,z:0}}},e.init=function(){var t=document.querySelector(".container"),i=document.querySelector(".emiliocanvas");l=(new I.q).load("img/emilio-0-new.jpg"),c=(new I.q).load("img/emilio-1-new.jpg"),u=(new I.q).load("img/kibble.png"),(a=new I.k(50,window.innerWidth/window.innerHeight,1,1e4)).position.set(0,400,2e3),(o=new I.n).background=new I.b(16777215),r=new I.p(100,32,32),(d=new I.g({map:l})).side=I.d,(p=new I.f(r,d)).name="Emilio",(x=new I.f).visible=!1,g=new I.i,x.add(g),v=new I.r,g.position.set(0,0,2e3),p.position.x=e.state.emilio.position.x,p.position.y=e.state.emilio.position.y,p.position.z=e.state.emilio.position.z,p.rotation.x=e.state.emilio.rotation.x,p.rotation.y=e.state.emilio.rotation.y,p.rotation.z=e.state.emilio.rotation.z,p.material.map.needsUpdate=!0,o.add(p),o.add(x),e.addShadow(),e.addKibble(),f=new I.m,(n=new I.t({antialias:!0})).setPixelRatio(window.devicePixelRatio),n.setSize(e.state.width,e.state.height),t.replaceChild(n.domElement,i),s=n.getContext("2d").canvas,e.setState({width:s.clientWidth,height:s.clientHeight})},e.animate=function(){requestAnimationFrame(e.animate),e.setState({timeElapsed:e.state.timeElapsed+1}),x.position.x=p.position.x,x.position.y=p.position.y,E.position.x=p.position.x,e.state.kibbleEaten>=99&&e.state.kibbleEaten<=499?(p.position.x+=30,Z=1.8):e.state.kibbleEaten>499&&e.state.kibbleEaten<=999?(p.position.x+=40,Z=2.2):e.state.kibbleEaten>999?(p.position.x+=70,Z=2.6):p.position.x+=20,p.position.y>10?(V||(p.position.y-=10),Q||(p.material.map=c)):p.position.y=0,(k=new I.r).set(p.position.x,p.position.y,0).normalize(),k.cross(I.i.DefaultUp),p.rotateOnAxis(k,-.05*Z),v.setFromMatrixPosition(g.matrixWorld),a.position.lerp(v,.4),a.lookAt(x.position),a.updateProjectionMatrix();var t=o.background;o.background=null,S.visible=!1,o.overrideMaterial=C,n.setRenderTarget(z),n.render(o,M),o.overrideMaterial=null,S.visible=!0,e.blurShadow(e.state.shadow.blur),e.blurShadow(.4*e.state.shadow.blur),n.setRenderTarget(null),o.background=t,p.position.y<=0&&!Q&&(p.material.map=l),e.eatKibble(),V&&e.jump(),_?G+=1:G=0,e.twirl(),Q&&e.eat(),n.render(o,a),a.updateProjectionMatrix()},e.addShadow=function(){(E=new I.e).position.y=-100,o.add(E),(z=new I.s(512,512)).texture.generateMipmaps=!1,(j=new I.s(512,512)).texture.generateMipmaps=!1;var t=new I.l($,ee).rotateX(Math.PI/2),i=new I.g({map:z.texture,opacity:e.state.shadow.opacity,transparent:!0});P=new I.f(t,i),E.add(P),P.scale.y=-1,(q=new I.f(t)).visible=!1,E.add(q),i=new I.g({color:e.state.plane.color,opacity:e.state.plane.opacity,transparent:!0}),(W=new I.f(t,i)).rotateX(Math.PI/2),E.add(W),(M=new I.j(-$/2,$/2,ee/2,-ee/2,0,te)).rotation.x=Math.PI/2,E.add(M),S=new I.a(M),(C=new I.h).userData.darkness={value:e.state.shadow.darkness},C.onBeforeCompile=function(e){e.uniforms.darkness=C.userData.darkness,e.fragmentShader="\n        uniform float darkness;\n        ".concat(e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );"),"\n    ")},C.depthTest=!1,C.depthWrite=!1,(T=new I.o(L.a)).depthTest=!1,(K=new I.o(J.a)).depthTest=!1},e.blurShadow=function(t){q.visible=!0,q.material=T,q.material.uniforms.tDiffuse.value=z.texture,T.uniforms.h.value=1*t/e.state.width*2,n.setRenderTarget(j),n.render(q,M),q.material=K,q.material.uniforms.tDiffuse.value=j.texture,K.uniforms.v.value=1*t/e.state.height*2,n.setRenderTarget(z),n.render(q,M),q.visible=!1},e.addKibble=function(){m=new I.c(100,100,200,200),(w=new I.g({map:u,transparent:!0})).side=I.d;for(var e=0;e<100;e++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=1e3+400*e,h.position.y=Math.abs(1e3*Math.sin(.3*e)+0),h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(e=0;e<20;e++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=5e3+200*e,h.position.y=3e3,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(e=0;e<20;e++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=5e3+200*e,h.position.y=3250,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(e=0;e<20;e++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=5e3+200*e,h.position.y=3500,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h)},e.eatKibble=function(){if(f.set(p.position,new I.r(-1,1,0)),p.geometry.computeBoundingBox(),y=f.intersectObjects(U),Q=!1,y.length>0){if(Q=!0,b=y[0].object.uuid,!X.includes(b)){X.push(b);for(var t=0;t<10;t++)e.setState({emilio:{isEating:!0},kibbleEaten:e.state.kibbleEaten+1})}}else Q=!1,e.setState({emilio:{isEating:!1}});console.log(X);for(var i=0;i<y.length;i++)y.length>0&&"Kibble"===y[i].object.name&&(y[i].object.visible=!1)},e.eat=function(){_||(p.rotation.x=-.2,p.rotation.y=6.5,p.rotation.z=-1.2),requestAnimationFrame((function(){p.material.map===l?setTimeout((function(){p.material.map=c,p.material.map===c&&setTimeout((function(){p.material.map=l}),60)}),60):setTimeout((function(){p.material.map=l}),60)}))},e.twirl=function(){switch(_){case!0:p.rotation.z=-1.2,p.rotation.x=-.1,p.rotation.y=G,p.rotation.y>=34&&(p.rotation.y=34.4);break;case!1:p.rotation.x=0,p.rotation.y=6.5}},e.jump=function(){(Y+=Y+1)<=150?p.position.y<4e3&&(p.position.y+=30+2*Math.sin(Y)):(V=!1,Y=0)},e.rotateCamera=function(){e.state.width<e.state.height&&(ee=4*window.innerWidth,$=4*window.innerHeight,te=500,a.up=new I.r(-1,0,0),a.updateProjectionMatrix(),document.body.classList.add("mobile"))},e}return Object(H.a)(i,[{key:"componentDidMount",value:function(){this.init(),this.animate(),this.rotateCamera(),document.addEventListener("keydown",(function(e){if(32===e.keyCode&&(V=!0),84===e.keyCode)switch(_){case!1:_=!0;break;case!0:_=!1}})),window.addEventListener("touchstart",(function(){V=!0}))}},{key:"render",value:function(){return D.a.createElement("div",{className:"container"},D.a.createElement("div",{className:"note"},"press the spacebar or tap to jump"),D.a.createElement("div",{id:"count",className:"".concat(this.state.emilio.isEating?"active":"")},this.state.kibbleEaten),D.a.createElement("div",{className:"emiliocanvas"}))}}]),i}(A.Component);i(17);var ae=function(){return D.a.createElement("div",{className:"App"},D.a.createElement(ie,null))};R.a.render(D.a.createElement(D.a.StrictMode,null,D.a.createElement(ae,null)),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.cfdec319.chunk.js.map