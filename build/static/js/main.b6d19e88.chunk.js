(this["webpackJsonpmilio-food"]=this["webpackJsonpmilio-food"]||[]).push([[0],{11:function(t,e,a){t.exports=a(18)},16:function(t,e,a){},17:function(t,e,a){},18:function(t,e,a){"use strict";a.r(e);var i,o,n,s,r,l,c,d,p,m,u,w,h,b,f,y,x,g,v,z,k,E,M,j,S,C,K,T,P,q,W,A=a(1),D=a.n(A),O=a(7),R=a.n(O),F=(a(16),a(2)),H=a(8),N=a(4),B=a(3),I=a(0),L=a(9),J=a(10),U=[],X=[],Z=1.4,_=!1,G=0,Q=!1,V=!1,Y=0,$=4*window.innerWidth,tt=4*window.innerHeight,et=500,at=function(t){Object(N.a)(a,t);var e=Object(B.a)(a);function a(){var t;Object(F.a)(this,a);for(var A=arguments.length,D=new Array(A),O=0;O<A;O++)D[O]=arguments[O];return(t=e.call.apply(e,[this].concat(D))).state={timeElapsed:0,width:window.innerWidth,height:window.innerHeight,shadow:{blur:3.5,darkness:1,opacity:1},plane:{color:"#ffffff",opacity:1},kibbleEaten:0,emilio:{isEating:!1,isTwirling:null,position:{x:-700,y:500,z:0},rotation:{x:0,y:6.5,z:0}}},t.init=function(){var e=document.querySelector(".container"),a=document.querySelector(".emiliocanvas");l=(new I.q).load("img/emilio-0-new.jpg"),c=(new I.q).load("img/emilio-1-new.jpg"),u=(new I.q).load("img/kibble.png"),(i=new I.k(50,window.innerWidth/window.innerHeight,1,1e4)).position.set(0,400,2e3),(o=new I.n).background=new I.b(16777215),r=new I.p(100,32,32),(d=new I.g({map:l})).side=I.d,(p=new I.f(r,d)).name="Emilio",(x=new I.f).visible=!1,g=new I.i,x.add(g),v=new I.r,g.position.set(0,0,2e3),p.position.x=t.state.emilio.position.x,p.position.y=t.state.emilio.position.y,p.position.z=t.state.emilio.position.z,p.rotation.x=t.state.emilio.rotation.x,p.rotation.y=t.state.emilio.rotation.y,p.rotation.z=t.state.emilio.rotation.z,p.material.map.needsUpdate=!0,o.add(p),o.add(x),t.addShadow(),t.addKibble(),f=new I.m,(n=new I.t({antialias:!0})).setPixelRatio(window.devicePixelRatio),n.setSize(t.state.width,t.state.height),e.replaceChild(n.domElement,a),s=n.getContext("2d").canvas,t.setState({width:s.clientWidth,height:s.clientHeight})},t.animate=function(){requestAnimationFrame(t.animate),t.setState({timeElapsed:t.state.timeElapsed+1}),x.position.x=p.position.x,x.position.y=p.position.y,k.position.x=p.position.x,t.state.kibbleEaten>=49&&t.state.kibbleEaten<=299?(p.position.x+=30,Z=1.8):t.state.kibbleEaten>299&&t.state.kibbleEaten<=599?(p.position.x+=40,Z=2.2):t.state.kibbleEaten>599?(p.position.x+=70,Z=2.6):p.position.x+=20,p.position.y>10?(V||(p.position.y-=10),Q||(p.material.map=c)):p.position.y=0,(z=new I.r).set(p.position.x,p.position.y,0).normalize(),z.cross(I.i.DefaultUp),p.rotateOnAxis(z,-.05*Z),v.setFromMatrixPosition(g.matrixWorld),i.position.lerp(v,.4),i.lookAt(x.position),i.updateProjectionMatrix();var e=o.background;o.background=null,S.visible=!1,o.overrideMaterial=C,n.setRenderTarget(E),n.render(o,j),o.overrideMaterial=null,S.visible=!0,t.blurShadow(t.state.shadow.blur),t.blurShadow(.4*t.state.shadow.blur),n.setRenderTarget(null),o.background=e,p.position.y<=0&&!Q&&(p.material.map=l),t.eatKibble(),V&&t.jump(),_?G+=1:G=0,t.twirl(),Q&&t.eat(),n.render(o,i),i.updateProjectionMatrix()},t.addShadow=function(){(k=new I.e).position.y=-100,o.add(k),(E=new I.s(512,512)).texture.generateMipmaps=!1,(M=new I.s(512,512)).texture.generateMipmaps=!1;var e=new I.l($,tt).rotateX(Math.PI/2),a=new I.g({map:E.texture,opacity:t.state.shadow.opacity,transparent:!0});P=new I.f(e,a),k.add(P),P.scale.y=-1,(q=new I.f(e)).visible=!1,k.add(q),a=new I.g({color:t.state.plane.color,opacity:t.state.plane.opacity,transparent:!0}),(W=new I.f(e,a)).rotateX(Math.PI/2),k.add(W),(j=new I.j(-$/2,$/2,tt/2,-tt/2,0,et)).rotation.x=Math.PI/2,k.add(j),S=new I.a(j),(C=new I.h).userData.darkness={value:t.state.shadow.darkness},C.onBeforeCompile=function(t){t.uniforms.darkness=C.userData.darkness,t.fragmentShader="\n        uniform float darkness;\n        ".concat(t.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );"),"\n    ")},C.depthTest=!1,C.depthWrite=!1,(K=new I.o(L.a)).depthTest=!1,(T=new I.o(J.a)).depthTest=!1},t.blurShadow=function(e){q.visible=!0,q.material=K,q.material.uniforms.tDiffuse.value=E.texture,K.uniforms.h.value=1*e/t.state.width*2,n.setRenderTarget(M),n.render(q,j),q.material=T,q.material.uniforms.tDiffuse.value=M.texture,T.uniforms.v.value=1*e/t.state.height*2,n.setRenderTarget(E),n.render(q,j),q.visible=!1},t.addKibble=function(){m=new I.c(100,100,200,200),(w=new I.g({map:u,transparent:!0})).side=I.d;for(var t=0;t<2;t++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=100+400*t,h.position.y=0,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(t=0;t<100;t++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=1e3+300*t,h.position.y=Math.abs(1e3*Math.sin(.3*t)+0),h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(t=0;t<20;t++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=31700+200*t,h.position.y=2200,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(t=0;t<20;t++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=31700+200*t,h.position.y=2450,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(t=0;t<20;t++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=31700+200*t,h.position.y=2700,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h);for(t=0;t<800;t++)(h=new I.f(m,w)).rotation.x=p.rotation.x,h.rotation.y=p.rotation.y,h.rotation.z=p.rotation.z,h.position.x=169300*Math.random()+30700,h.position.y=1500*Math.random()+0,h.scale.set(h.scale.x=.8*h.scale.x,h.scale.y=.8*h.scale.y,h.scale.z=.8*h.scale.z),h.name="Kibble",o.add(h),U.push(h)},t.eatKibble=function(){if(f.set(p.position,new I.r(-1,1,0)),p.geometry.computeBoundingBox(),y=f.intersectObjects(U),Q=!1,y.length>0){if(Q=!0,b=y[0].object.uuid,!X.includes(b)){X.push(b);for(var e=0;e<10;e++)t.setState({emilio:{isEating:!0},kibbleEaten:t.state.kibbleEaten+1})}}else Q=!1,t.setState({emilio:{isEating:!1}});console.log(X);for(var a=0;a<y.length;a++)y.length>0&&"Kibble"===y[a].object.name&&(y[a].object.visible=!1)},t.eat=function(){_||(p.rotation.x=-.2,p.rotation.y=6.5,p.rotation.z=-1.2),requestAnimationFrame((function(){p.material.map===l?setTimeout((function(){p.material.map=c,p.material.map===c&&setTimeout((function(){p.material.map=l}),60)}),60):setTimeout((function(){p.material.map=l}),60)}))},t.twirl=function(){switch(_){case!0:p.rotation.z=-1.2,p.rotation.x=-.1,p.rotation.y=G,p.rotation.y>=34&&(p.rotation.y=34.4);break;case!1:p.rotation.x=0,p.rotation.y=6.5}},t.jump=function(){(Y+=Y+1)<=150?p.position.y<4e3&&(p.position.y+=30+2*Math.sin(Y)):(V=!1,Y=0)},t.rotateCamera=function(){t.state.width<t.state.height&&(tt=4*window.innerWidth,$=4*window.innerHeight,et=500,i.up=new I.r(-1,0,0),i.updateProjectionMatrix(),document.body.classList.add("mobile"))},t}return Object(H.a)(a,[{key:"componentDidMount",value:function(){this.init(),this.animate(),this.rotateCamera(),document.addEventListener("keydown",(function(t){if(32===t.keyCode&&(V=!0),84===t.keyCode)switch(_){case!1:_=!0;break;case!0:_=!1}})),window.addEventListener("touchstart",(function(){V=!0}))}},{key:"render",value:function(){return D.a.createElement("div",{className:"container"},D.a.createElement("div",{className:"note"},"press the spacebar or tap to jump"),D.a.createElement("div",{id:"count",className:"".concat(this.state.emilio.isEating?"active":"")},this.state.kibbleEaten),D.a.createElement("div",{className:"emiliocanvas"}))}}]),a}(A.Component);a(17);var it=function(){return D.a.createElement("div",{className:"App"},D.a.createElement(at,null))};R.a.render(D.a.createElement(D.a.StrictMode,null,D.a.createElement(it,null)),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.b6d19e88.chunk.js.map