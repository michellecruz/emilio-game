(this["webpackJsonpmilio-food"]=this["webpackJsonpmilio-food"]||[]).push([[0],{21:function(e,t,a){e.exports=a(39)},26:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var o=a(3),i=a.n(o),n=a(17),s=a.n(n),r=(a(26),a(4)),l=a(9),c=a(18),d=a(11),m=a(10),p=a(1),u=a(19),b=a(20),y=a(15),h=a.n(y);h.a.initializeApp({apiKey:"AIzaSyC4sirCRU4mSEkVVlzOndsvwa9K50DM0gY",authDomain:"emilio-game.firebaseapp.com",databaseURL:"https://emilio-game.firebaseio.com",projectId:"emilio-game",storageBucket:"emilio-game.appspot.com",messagingSenderId:"1095598874871",appId:"1:1095598874871:web:e94bb6051fb85ebd83f3f2",measurementId:"G-WVL1JPWRCJ"});var x,f,w,g,v,z,E,k,S,C,M,N,j,K,P,A,T,R,D,I,O,q,L,W,F,H,B,J,U,V,G,Y,X,Z,_,Q,$,ee,te,ae,oe=h.a,ie=[],ne=[],se=[],re=1.4,le=!1,ce=0,de=!1,me=!1,pe=0,ue=!1,be=!1,ye=!1,he=!1,xe=4*window.innerWidth,fe=4*window.innerHeight,we=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))).state={timeElapsed:0,width:window.innerWidth,height:window.innerHeight,shadow:{blur:3.5,darkness:1,opacity:1},plane:{color:"#ffffff",opacity:1},emilio:{isEating:!1,isTwirling:null,position:{x:-700,y:500,z:0},rotation:{x:0,y:6.5,z:0}},kibbleEaten:0,totalKibble:ie.length,playerName:"",topPlayers:[]},e.handleChange=function(t){e.setState(Object(r.a)({},t.target.name,t.target.value))},e.handleSubmit=function(t){t.preventDefault();var a=oe.database().ref("players"),o={name:e.state.playerName?e.state.playerName:"Anonymous",score:e.state.kibbleEaten,time:oe.database.ServerValue.TIMESTAMP};a.push(o),e.setState({playerName:""})},e.handleClick=function(){document.querySelector(".form").classList.add("fade-out"),document.querySelector(".leaderboard").classList.add("fade-in");var e=document.querySelector(".container"),t=document.querySelector(".game");e.removeChild(t)},e.handleRefresh=function(){window.location.reload()},e.init=function(){var t=document.querySelector(".emiliocanvas");k=(new p.r).load("img/060420-emilio-0.jpg"),S=(new p.r).load("img/060420-emilio-1.jpg"),j=(new p.r).load("img/kibble.jpg"),D=(new p.r).load("img/treat.png"),(w=new p.l(50,window.innerWidth/window.innerHeight,1,1e4)).position.set(0,400,2e3),(g=new p.o).background=new p.c(16777215),E=new p.q(100,32,32),(C=new p.h({map:k})).side=p.e,(M=new p.g(E,C)).name="Emilio",(F=new p.g).visible=!1,H=new p.j,F.add(H),B=new p.s,H.position.set(0,0,2e3),M.position.x=e.state.emilio.position.x,M.position.y=e.state.emilio.position.y,M.position.z=e.state.emilio.position.z,M.rotation.x=e.state.emilio.rotation.x,M.rotation.y=e.state.emilio.rotation.y,M.rotation.z=e.state.emilio.rotation.z,g.add(M),g.add(F),e.addShadow(),e.addKibble(),q=new p.n,(v=new p.u({antialias:!0})).setPixelRatio(window.devicePixelRatio),v.setSize(e.state.width,e.state.height),x.replaceChild(v.domElement,t),z=v.getContext("2d").canvas,e.setState({width:z.clientWidth,height:z.clientHeight})},e.animate=function(){f=requestAnimationFrame(e.animate),e.setState({timeElapsed:e.state.timeElapsed+1}),e.state.kibbleEaten>=15&&e.state.kibbleEaten<=100?(M.position.x+=30,re=1.8):e.state.kibbleEaten>100&&e.state.kibbleEaten<=700?(M.position.x+=40,re=2.2):e.state.kibbleEaten>700?(M.position.x+=60,re=2.6):M.position.x+=20,F.position.x=M.position.x,F.position.y=M.position.y,V.position.x=M.position.x,ue?(M.scale.x<3.5?M.scale.set(M.scale.x+.1,M.scale.y+.1,M.scale.z+.1):M.scale.set(3.5,3.5,3.5),M.position.y>250?me||(M.position.y-=10):M.position.y=250):M.position.y>10?me||(M.position.y-=10):M.position.y=0,(J=new p.s).set(M.position.x,M.position.y,0).normalize(),J.cross(p.j.DefaultUp),be||M.rotateOnAxis(J,-.05*re),(U=new p.s).set(-.5,-.5,0).normalize(),U.cross(p.j.DefaultUp),O.rotateOnAxis(U,-.005*re),B.setFromMatrixPosition(H.matrixWorld),w.position.lerp(B,.8),w.lookAt(F.position),w.updateProjectionMatrix();var t=g.background;g.background=null,Z.visible=!1,g.overrideMaterial=_,v.setRenderTarget(G),v.render(g,X),g.overrideMaterial=null,Z.visible=!0,e.blurShadow(e.state.shadow.blur),e.blurShadow(.4*e.state.shadow.blur),v.setRenderTarget(null),g.background=t,de||(M.material.map=k),e.eatKibble(),me&&e.jump(),le?ce+=1:ce=0,e.twirl(),de&&e.eat(),M.position.x>=165e3&&e.endGame(),v.render(g,w),w.updateProjectionMatrix()},e.addShadow=function(){(V=new p.f).position.y=-100,g.add(V),(G=new p.t(512,512)).texture.generateMipmaps=!1,(Y=new p.t(512,512)).texture.generateMipmaps=!1;var t=new p.m(xe,fe).rotateX(Math.PI/2),a=new p.h({map:G.texture,opacity:e.state.shadow.opacity,transparent:!0});ee=new p.g(t,a),V.add(ee),ee.scale.y=-1,(te=new p.g(t)).visible=!1,V.add(te),a=new p.h({color:e.state.plane.color,opacity:e.state.plane.opacity,transparent:!0}),(ae=new p.g(t,a)).rotateX(Math.PI/2),V.add(ae),(X=new p.k(-xe/2,xe/2,fe/2,-fe/2,0,500)).rotation.x=Math.PI/2,V.add(X),Z=new p.b(X),(_=new p.i).userData.darkness={value:e.state.shadow.darkness},_.onBeforeCompile=function(e){e.uniforms.darkness=_.userData.darkness,e.fragmentShader="\n        uniform float darkness;\n        ".concat(e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );"),"\n    ")},_.depthTest=!1,_.depthWrite=!1,(Q=new p.p(u.a)).depthTest=!1,($=new p.p(b.a)).depthTest=!1},e.blurShadow=function(t){te.visible=!0,te.material=Q,te.material.uniforms.tDiffuse.value=G.texture,Q.uniforms.h.value=1*t/e.state.width*2,v.setRenderTarget(Y),v.render(te,X),te.material=$,te.material.uniforms.tDiffuse.value=Y.texture,$.uniforms.v.value=1*t/e.state.height*2,v.setRenderTarget(G),v.render(te,X),te.visible=!1},e.addKibble=function(){N=new p.d(100,100,200,200),(K=new p.h({map:j})).side=p.e;for(var t=0;t<5;t++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=100+400*t,P.position.y=0,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var a=0;a<50;a++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=2100+300*a,P.position.y=Math.abs(1e3*Math.sin(.25*a)+0),P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var o=0;o<10;o++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=17200+400*o,P.position.y=400+100*o,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var i=0;i<10;i++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=21600+400*i,P.position.y=850+100*i,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var n=0;n<50;n++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=26e3+300*n,P.position.y=1850,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var s=0;s<11;s++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=41e3+400*s,P.position.y=1850-100*s,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var r=0;r<100;r++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=45600+400*r,P.position.y=Math.abs(500*Math.sin(.25*r)+500),P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);R=new p.a(500,500,500),(I=new p.h({map:D,transparent:!0})).side=p.e,(O=new p.g(R,I)).position.x=85495,O.position.y=1200*Math.random()+500,O.scale.set(O.scale.x=.8*O.scale.x,O.scale.y=.8*O.scale.y,O.scale.z=.8*O.scale.z),O.name="Treat",g.add(O);for(var l=0;l<20;l++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=86e3+200*l,P.position.y=100,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var c=0;c<20;c++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=86e3+200*c,P.position.y=350,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var d=0;d<20;d++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=86e3+200*d,P.position.y=600,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var m=0;m<80;m++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=90400+400*m,P.position.y=Math.abs(600*Math.sin(.15*m)+0),P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);for(var u=0;u<224;u++)(P=new p.g(N,K)).rotation.x=M.rotation.x,P.rotation.y=M.rotation.y,P.rotation.z=M.rotation.z,P.position.x=37200*Math.random()+122800,P.position.y=200*Math.random()+200,P.scale.set(P.scale.x=.8*P.scale.x,P.scale.y=.8*P.scale.y,P.scale.z=.8*P.scale.z),P.name="Kibble",g.add(P),ie.push(P);e.setState({totalKibble:ie.length})},e.eatKibble=function(){ue?q.set(new p.s(M.position.x,M.position.y-250,0),new p.s(0,250,0).normalize()):q.set(M.position,new p.s(-1,1,0)),M.geometry.computeBoundingSphere(),L=q.intersectObjects(ie),de=!1,L.length>0?(de=!0,A=L[0].object.uuid,ne.includes(A)||(ne.push(A),e.setState({emilio:{isEating:!0},kibbleEaten:e.state.kibbleEaten+1}))):(de=!1,e.setState({emilio:{isEating:!1}})),(W=q.intersectObject(O)).length>0&&(T=W[0].object.uuid,se.includes(T)||(se.push(T),W[0].object.visible=!1,e.setState({kibbleEaten:e.state.kibbleEaten+50}),ue=!0));for(var t=0;t<L.length;t++)L.length>0&&"Kibble"===L[t].object.name&&(L[t].object.visible=!1)},e.eat=function(){le||(M.rotation.x=-.2,M.rotation.y=6.5,M.rotation.z=-1.2),M.material.map=S},e.twirl=function(){switch(le){case!0:M.rotation.z=-1.2,M.rotation.x=-.1,M.rotation.y=ce,M.rotation.y>=34&&(M.rotation.y=34.4);break;case!1:M.rotation.x=0,M.rotation.y=6.5;break;default:return}},e.jump=function(){(pe+=pe+1)<=150?M.position.y<4e3&&(M.position.y+=30+2*Math.sin(pe)):(me=!1,pe=0)},e.rotateCamera=function(){e.state.width<e.state.height&&(w.up=new p.s(-1,0,0),H.position.set(0,0,3e3),w.updateProjectionMatrix(),document.body.classList.add("mobile"),!0)},e.endGame=function(){ue=!0,be=!0,M.position.x=165e3,0===[].concat(e.state.topPlayers).sort((function(e,t){return t.score-e.score})).slice(0,5).map((function(t,a){e.state.kibbleEaten>=t.score&&(ye=!0)})).length&&(ye=!0);for(var t=0;t>10;t++)cancelAnimationFrame(f)},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;x=document.querySelector(".game"),this.init(),this.animate(),this.rotateCamera(),document.addEventListener("keydown",(function(t){if(32===t.keyCode&&(me=!0),84===t.keyCode)switch(le){case!1:le=!0;break;case!0:le=!1;break;default:return}if(37===t.keyCode){var a=M.position.x;M.position.lerp(new p.s(a-2e4,M.position.y,0),.1)}if(39===t.keyCode){var o=M.position.x;M.position.lerp(new p.s(o+2e4,M.position.y,0),.1)}80===t.keyCode&&((he=!he)?cancelAnimationFrame(f):requestAnimationFrame(e.animate))})),window.addEventListener("touchstart",(function(){me=!0})),oe.database().ref("players").on("value",(function(t){var a=t.val(),o=[];for(var i in a)o.push({id:i,name:a[i].name,score:a[i].score,time:a[i].time});e.setState({topPlayers:o})}))}},{key:"render",value:function(){return i.a.createElement("div",{className:"container"},ye&&i.a.createElement("div",{className:"form"},i.a.createElement("div",{className:"form-wrapper"},i.a.createElement("h1",null,"WH",i.a.createElement("span",{className:"butt-container"},i.a.createElement("img",{src:"img/butt.png",className:"image image-butt"})),"A",i.a.createElement("span",{className:"form-score"},this.state.kibbleEaten,"!")),i.a.createElement("h2",null,"You made it onto",i.a.createElement("br",null),"Emilio's leaderboard"),i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement("input",{type:"text",maxLength:"12",name:"playerName",placeholder:"Type your name",autoComplete:"off",onChange:this.handleChange,value:this.state.playerName}),i.a.createElement("button",{onClick:this.handleClick},"Submit")))),be&&i.a.createElement("div",{className:ye?"leaderboard":"leaderboard fade-in"},i.a.createElement("div",{className:"leaderboard-wrapper"},i.a.createElement("h1",null,"T",i.a.createElement("span",{className:"butt-container"},i.a.createElement("img",{src:"img/butt.png",className:"image image-butt"})),"P PLAYERS"),[].concat(this.state.topPlayers).sort((function(e,t){return t.time-e.time})).sort((function(e,t){return t.score-e.score})).slice(0,5).map((function(e,t){return i.a.createElement("div",{className:"player",key:t},i.a.createElement("div",{className:"player-name"},i.a.createElement("h2",null,e.name)),i.a.createElement("div",{className:"player-score"},i.a.createElement("h2",null,e.score)))})),i.a.createElement("button",{onClick:this.handleRefresh},"Play Again"))),i.a.createElement("div",{className:"game"},i.a.createElement("div",{className:"note"},i.a.createElement("span",{className:"desktop"},"press the spacebar"),i.a.createElement("span",{className:"mobile-div"},"tap to jump")),i.a.createElement("div",{id:"count",className:"".concat(this.state.emilio.isEating?"active":"")},this.state.kibbleEaten," / ",this.state.totalKibble),i.a.createElement("div",{className:"emiliocanvas"})))}}]),a}(o.Component);a(38);var ge=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(we,null))};s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(ge,null)),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.cecc8cfd.chunk.js.map